<html>
<head>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
</head>
<section>
    <h1>
        Covid-19: Aktuelle Situation in Salzburg
    </h1>
    <p>
        Automatisch generierte graphische Representation der Daten aus dem COVID-19 Dashboard des Landes Salzburg.
    </p>
    <p>
        Datenquelle: <a
            href="https://www.salzburg.gv.at/api5/datalinq/report/kribe@offentlichuebersicht@offentlichuebersicht">https://www.salzburg.gv.at/api5/datalinq/report/kribe@offentlichuebersicht@offentlichuebersicht</a>
    </p>
</section>
<section>
    <h2>Aktive Pinzgau</h2>
    <canvas id="Pinzgau"></canvas>
</section>
<section>
    <h2>Aktive Tennengau</h2>
    <canvas id="Tennengau"></canvas>
</section>
<section>
    <h2>Aktive Pongau</h2>
    <canvas id="Pongau"></canvas>
</section>
<section>
    <h2>Aktive Lungau</h2>
    <canvas id="Lungau"></canvas>
</section>
<section>
    <h2>Aktive Flachgau</h2>
    <canvas id="Flachgau"></canvas>
</section>
<section>
    <h2>Aktive Salzburg Stadt</h2>
    <canvas id="Salzburg Stadt"></canvas>
</section>

<section>
    <h3>Impressum</h3>
    <p>
        <b>Betreiber der Webseite:</b><br>
        Verein: Team122.at<br>
        Kellau 198<br>
        AT- 5431 Kuchl/Salzburg<br>
        info@122.co.at<br>
        +43 6604 122 122<br>
        Rechtsform: Verein<br>
        Vereinssitz: Kuchl<br>
        ZVR-Zahl 1080728609<br>
        Behörde gem. ECG (E-Commerce Gesetz): Bezirkshauptmannschaft Hallein<br>
    </p>
</section>
<script>

    const colors = ['#e6194b', '#3cb44b', '#ffe119', '#4363d8', '#f58231', '#911eb4', '#46f0f0', '#f032e6', '#bcf60c', '#fabebe', '#008080', '#e6beff', '#9a6324', '#fffac8', '#800000', '#aaffc3', '#808000', '#ffd8b1', '#000075', '#808080', '#ffffff', '#000000'];

    function initChart(gesamt, district, type) {
        const datasets = [];
        Object.keys(gesamt[district]).forEach((town, i) => {
            const data = [];
            Object.keys(gesamt[district][town][type]).map((date, x) => {
                data.push({
                    x: date,
                    y: parseInt(gesamt[district][town][type][date])
                });
            });
            datasets.push({
                label: town,
                data: data,
                borderColor: colors[i % colors.length],
                backgroundColor: 'transparent',
                hidden: false,
            })
        });
        if (district !== 'Salzburg Stadt') {
            datasets[0].hidden = true;
        }
        const ctx = document.getElementById(district);
        const chart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: datasets[0].data.map(d => d.x),
                datasets
            },
            options: {
                legend: {
                    position: 'left'
                }
            }
        });
    }

    fetch("./gesamt.json").then(response => response.json()).then(gesamt => {
        Object.keys(gesamt).forEach(district => {
            const type = 'aktiv';
            initChart(gesamt, district, type);
        });
    });
</script>

</html>